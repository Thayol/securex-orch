{
  "workflow": {
    "unique_name": "definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh",
    "name": "T1091 Replication Through Removable Media",
    "title": "T1091 Replication Through Removable Media",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 2,
          "scope": "local",
          "name": "Malicious Counter Threshold",
          "type": "datatype.integer",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SNJW5SGYXCP43FuUQWwgmrkGmxObAN7H5",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 69,
          "scope": "local",
          "name": "Threat Score Threshold",
          "type": "datatype.integer",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SK37ZJTKPAS5p6H1I2q3MOpPRwrY9J1lO",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "unused",
          "type": "datatype.integer",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SK0H1S2WOM81nCltfRnuAoB6X210dKx71",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": false,
          "scope": "local",
          "name": "Whitelisted",
          "type": "datatype.boolean",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SK0K4OTAAGW32lNTJ8MKErXhyaZzqCprT",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "observable_type",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SDM6R5H7A512uRegmHdq23z6qnfhoaKhc",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_01SK0TY4KM6ZE46lC8puhXooy760EFgNm0Q",
        "properties": {
          "scope": "local",
          "name": "Potential Hashes",
          "type": "datatype.table",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SK0UPSK5QUL1C01R3V2SVC5SHOGY2mmKg",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": false,
          "scope": "local",
          "name": "Blacklisted",
          "type": "datatype.boolean",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SW20QH65RFL4qvyXcLHJOeevgaeisb0s6",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "Threat Score",
          "type": "datatype.integer",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SK0E55SMEOT4eLCchEcpr9OI9ogi7McRS",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "observable_value",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01SDM6U7VN8C103SCbGMSpp3WnFOM33zUHZ",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "display_name": "T1091 Replication Through Removable Media",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "no_target": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01SNK66CXXZ1I2V17XtqoIt5dQpubD38Tgj",
        "name": "Group",
        "title": "Process Input",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Process Input",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01SDN05H4OMWU5BlbNPCSaavgt6VMAh69xE",
            "name": "Execute Python Script",
            "title": "Decode Input to JSON",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Decode Input to JSON",
              "script": "import base64\n\nbase64_message = '$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.input.variable_workflow_01SDM6U7VN8C103SCbGMSpp3WnFOM33zUHZ$'\nbase64_bytes = base64_message.encode('ascii')\nmessage_bytes = base64.b64decode(base64_bytes)\nmessage = message_bytes.decode('ascii')",
              "script_queries": [
                {
                  "script_query": "message",
                  "script_query_name": "Response",
                  "script_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01SHSDBW5NIAC3DAP0wDqPMCQ19QqseUvJg",
            "name": "Read Table from JSON",
            "title": "Read JSON to Table",
            "type": "corejava.read_table_from_json",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Read JSON to Table",
              "input_json": "$activity.definition_activity_01SDN05H4OMWU5BlbNPCSaavgt6VMAh69xE.output.script_queries.Response$",
              "jsonpath_query": "$.drives",
              "persist_output": false,
              "populate_columns": false,
              "skip_execution": false,
              "table_columns": [
                {
                  "column_name": "letter",
                  "column_type": "string"
                },
                {
                  "column_name": "file",
                  "column_type": "string"
                },
                {
                  "column_name": "hash",
                  "column_type": "string"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01SK0IU2WG1WQ3PtfczrtiKe9dZGnxVfoFs",
        "name": "For Each",
        "title": "EXCLUDE WHITELISTED",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "EXCLUDE WHITELISTED",
          "skip_execution": false,
          "source_array": "$activity.definition_activity_01SHSDBW5NIAC3DAP0wDqPMCQ19QqseUvJg.output.read_table_from_json$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01SK0K8VS78AQ22k7PDErl9ccJBW8VFttBH",
            "name": "Set Variables",
            "title": "Reset Whitelisted Flag",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Reset Whitelisted Flag",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SK0K4OTAAGW32lNTJ8MKErXhyaZzqCprT$",
                  "variable_value_new": false
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01SK0J2GE3F7H4fb3o6ztCntiQxfJCUnkNk",
            "name": "For Each",
            "title": "Loop Whitelist",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Loop Whitelist",
              "skip_execution": false,
              "source_array": "$global.variable_01SBMZJERN1F95k9yNMjRMOYHRRfMl0fpmd.global.variable_01SBMZJERN1F95k9yNMjRMOYHRRfMl0fpmd$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01SK0KE6JWTU10FJXC2lXSVp3HDzxJOCsjt",
                "name": "Condition Block",
                "title": "Are the hashes the same?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Are the hashes the same?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01SK0KE6PVNLL6z8JgUMkfUE3YLusWohxuN",
                    "name": "Condition Branch",
                    "title": "Condition Branch",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01SK0IU2WG1WQ3PtfczrtiKe9dZGnxVfoFs.input.source_array[@].hash$",
                        "operator": "eq",
                        "right_operand": "$activity.definition_activity_01SK0J2GE3F7H4fb3o6ztCntiQxfJCUnkNk.input.source_array[@].hash$"
                      },
                      "continue_on_failure": false,
                      "display_name": "Condition Branch",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01SK0KARAPDKC4cMCvTMg9ftf9bs6UavwVI",
                        "name": "Set Variables",
                        "title": "Set Whitelisted Flag",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set Whitelisted Flag",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SK0K4OTAAGW32lNTJ8MKErXhyaZzqCprT$",
                              "variable_value_new": true
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01SK0RIA62CB64dHQaTPO6t2t7CTZPs1ciz",
                        "name": "Break",
                        "title": "Break",
                        "type": "logic.break",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Break",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01SK120CZ4T0N7SmWQLqlSWm7Zx4YTTNd9x",
            "name": "Condition Block",
            "title": "Is it whitelisted?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Is it whitelisted?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01SK120D7Z3663B4ZjFX5mTpMD1IBmX65M2",
                "name": "Condition Branch",
                "title": "No, It is not whitelisted",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SK0K4OTAAGW32lNTJ8MKErXhyaZzqCprT$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "No, It is not whitelisted",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01SK0UYE2KZ1F7UJl8c21DSLcz3VL6gPLkb",
                    "name": "Add Row to Table",
                    "title": "Add to Potential Hashes",
                    "type": "core.addrowtotable",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Add to Potential Hashes",
                      "input_table": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SK0UPSK5QUL1C01R3V2SVC5SHOGY2mmKg$",
                      "row": [
                        {
                          "key": "item",
                          "type": "string",
                          "value": "$activity.definition_activity_01SK0IU2WG1WQ3PtfczrtiKe9dZGnxVfoFs.input.source_array[@].hash$"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01SK120DHUT093k7wPYBOA1MGQ9fuxmG1vr",
                "name": "Condition Branch",
                "title": "Yes, It is whitelisted",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SK0K4OTAAGW32lNTJ8MKErXhyaZzqCprT$",
                    "operator": "eq",
                    "right_operand": true
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes, It is whitelisted",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01SK12TGW8XBC0nVi6YGIyHLVNLqSyoRk5Y",
                    "name": "Set Variables",
                    "title": "Exclude File",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Exclude File",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SK0H1S2WOM81nCltfRnuAoB6X210dKx71$",
                          "variable_value_new": 0
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01SHSH4NKY7MW3IESskeGhJ5oHEEj3A0B0C",
        "name": "For Each",
        "title": "For Each Potential Hash",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "For Each Potential Hash",
          "skip_execution": false,
          "source_array": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SK0UPSK5QUL1C01R3V2SVC5SHOGY2mmKg$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01SW20V1HL10006RzuL13qNx1SljzU8mmw8",
            "name": "Set Variables",
            "title": "Reset Blacklist Flag",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Reset Blacklist Flag",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SW20QH65RFL4qvyXcLHJOeevgaeisb0s6$",
                  "variable_value_new": false
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01SNILIUK7VBU5lH0LzV0YbI8sgtQHVhFnB",
            "name": "Parallel Block",
            "title": "Parallel Queries",
            "type": "logic.parallel",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Parallel Queries",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01SNJNB79BD9134rnt3rfqkwfhzuTjCaoSD",
                "name": "Parallel Branch",
                "title": "Threat Grid Branch",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Grid Branch",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01SW1XSG6OF1F2LXmopKuBRy66fPZSo4DIF",
                    "name": "Parallel Block",
                    "title": "Get Threat Score",
                    "type": "logic.parallel",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Get Threat Score",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01SW1XSGDRXX97dHmWwoJoutHDggXfPXgY9",
                        "name": "Parallel Branch",
                        "title": "Blacklist Branch",
                        "type": "logic.parallel_block",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Blacklist Branch",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01SW1S4JFE3B56fSqplQaK19WPfsouBk3eQ",
                            "name": "HTTP Request",
                            "title": "Get AMP Blacklist",
                            "type": "web-service.http_request",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 60,
                              "allow_auto_redirect": true,
                              "continue_on_error_status_code": false,
                              "continue_on_failure": false,
                              "display_name": "Get AMP Blacklist",
                              "method": "GET",
                              "relative_url": "file_lists/737ade70-89d7-4096-84f6-23e14649c828/files",
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target": true,
                                "target_id": "definition_target_01S9WJLG94O1A0HkwcNgLRoEkbShHGfAJdP"
                              }
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01SW1WM3PRYKW33iqPVNWkdxZkev9VaQ9RX",
                            "name": "Read Table from JSON",
                            "title": "Read Blacklist",
                            "type": "corejava.read_table_from_json",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 30,
                              "continue_on_failure": false,
                              "display_name": "Read Blacklist",
                              "input_json": "$activity.definition_activity_01SW1S4JFE3B56fSqplQaK19WPfsouBk3eQ.output.response_body$",
                              "jsonpath_query": "$.data.items",
                              "persist_output": false,
                              "populate_columns": false,
                              "skip_execution": false,
                              "table_columns": [
                                {
                                  "column_name": "sha256",
                                  "column_type": "string"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01SW1ZA7R42RE4TrVY0Vkhwdc0pkR1RQtET",
                            "name": "For Each",
                            "title": "Loop Hashes",
                            "type": "logic.for_each",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Loop Hashes",
                              "skip_execution": false,
                              "source_array": "$activity.definition_activity_01SW1WM3PRYKW33iqPVNWkdxZkev9VaQ9RX.output.read_table_from_json$"
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01SW1ZMYC1AQV2RoSY3MvV0pU2ncxDwHbCi",
                                "name": "Condition Block",
                                "title": "Is hash blacklisted?",
                                "type": "logic.if_else",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Is hash blacklisted?",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "blocks": [
                                  {
                                    "unique_name": "definition_activity_01SW1ZMYKT2Q54SrDQfyzwriBwB2OgkGQjC",
                                    "name": "Condition Branch",
                                    "title": "Yes, it is blacklisted",
                                    "type": "logic.condition_block",
                                    "base_type": "activity",
                                    "properties": {
                                      "condition": {
                                        "left_operand": "$activity.definition_activity_01SW1ZA7R42RE4TrVY0Vkhwdc0pkR1RQtET.input.source_array[@].sha256$",
                                        "operator": "eq",
                                        "right_operand": "$activity.definition_activity_01SHSH4NKY7MW3IESskeGhJ5oHEEj3A0B0C.input.source_array[@].item$"
                                      },
                                      "continue_on_failure": false,
                                      "display_name": "Yes, it is blacklisted",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01SW212ROELD021lrOclBvpLbq9UlA02KGP",
                                        "name": "Set Variables",
                                        "title": "Set Blacklisted Flag",
                                        "type": "core.set_multiple_variables",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Set Blacklisted Flag",
                                          "skip_execution": false,
                                          "variables_to_update": [
                                            {
                                              "variable_to_update": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SW20QH65RFL4qvyXcLHJOeevgaeisb0s6$",
                                              "variable_value_new": true
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01SW1XSGLZIZ06Bb1qwf4u3REtN6sXhCVP2",
                        "name": "Parallel Branch",
                        "title": "Threat Score Branch",
                        "type": "logic.parallel_block",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Threat Score Branch",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01SNJNJ2V4XPS5dAiA4YpcjUZNx53EltKYg",
                            "name": "Get Highest Threat Grid Threat Score",
                            "title": "Get Highest Threat Grid Threat Score",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Get Highest Threat Grid Threat Score",
                              "input": {
                                "variable_workflow_01SNJHZMYBMBL1pHZSQ9gpqBCJapELyZAGR": "$activity.definition_activity_01SHSH4NKY7MW3IESskeGhJ5oHEEj3A0B0C.input.source_array[@].item$"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "no_target": true
                              },
                              "workflow_id": "definition_workflow_01SNJFC6HGYWW5JKCGBVOOUUZl4Sugo4HpA"
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01SNILIV7U0JQ6yCr3FFx2i2aDSBfQYK4Ar",
                "name": "Parallel Branch",
                "title": "VirusTotal Branch",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "VirusTotal Branch",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01SNJTY9NJ6153Du38Q7XYtKctqt1oK25eF",
                    "name": "Get VirusTotal Malicious Counter",
                    "title": "Get VirusTotal Malicious Counter",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Get VirusTotal Malicious Counter",
                      "input": {
                        "variable_workflow_01SNIQBI8QDK44DycXQ55QSrAi6IdSnBa8x": "$activity.definition_activity_01SHSH4NKY7MW3IESskeGhJ5oHEEj3A0B0C.input.source_array[@].item$"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "no_target": true
                      },
                      "workflow_id": "definition_workflow_01SNIPM3PE4PG6zHzzDOYlGFKOFXe6DQdIA"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01SK36PB19YTI7LxCrUYnqzmBB9gSGD2Jv9",
            "name": "Condition Block",
            "title": "Is threat score higher than the threshold?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Is threat score higher than the threshold?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01SK36PB7JMTO2z8lCy6Mb0PHznusA6uJMg",
                "name": "Condition Branch",
                "title": "Yes, it is a threat",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_01SNJNJ2V4XPS5dAiA4YpcjUZNx53EltKYg.output.variable_workflow_01SNJIAHMHGJG5souYAjvI8XTnK9xmheUnc$",
                        "operator": "gte",
                        "right_operand": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SK37ZJTKPAS5p6H1I2q3MOpPRwrY9J1lO$"
                      },
                      "operator": "or",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_01SNJTY9NJ6153Du38Q7XYtKctqt1oK25eF.output.variable_workflow_01SNJRW778W3U660rzcZbC9I9pqAzVEL8nD$",
                        "operator": "gte",
                        "right_operand": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SNJW5SGYXCP43FuUQWwgmrkGmxObAN7H5$"
                      }
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SW20QH65RFL4qvyXcLHJOeevgaeisb0s6$",
                      "operator": "eq",
                      "right_operand": true
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes, it is a threat",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01SN2J5XWMYM26XikEHsXehnJXiIWhOaWuD",
                    "name": "JSONPath Query",
                    "title": "Get Hostname and GUID",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Get Hostname and GUID",
                      "input_json": "$activity.definition_activity_01SDN05H4OMWU5BlbNPCSaavgt6VMAh69xE.output.script_queries.Response$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.guid",
                          "jsonpath_query_name": "GUID",
                          "jsonpath_query_type": "string"
                        },
                        {
                          "jsonpath_query": "$.host",
                          "jsonpath_query_name": "Hostname",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01SN2J0V076OM7m2NR37BtteMMoasMOMIB6",
                    "name": "Secure Endpoint - Isolate Host",
                    "title": "Secure Endpoint - Isolate Host",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": true,
                      "description": "The key is read-only. This is demonstration purposes only, so execution failure is allowed. We can reach the endpoint and it responds with a read-only error. It works, it serves as a proof...",
                      "display_name": "Secure Endpoint - Isolate Host",
                      "input": {
                        "variable_workflow_01PP77UWF61XC6J78V5wbJCUMq6FbLtlWMn": "$activity.definition_activity_01SN2J5XWMYM26XikEHsXehnJXiIWhOaWuD.output.jsonpath_queries.GUID$"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target": true,
                        "target_id": "definition_target_01S9WJLG94O1A0HkwcNgLRoEkbShHGfAJdP",
                        "target_type": "web-service.endpoint"
                      },
                      "workflow_id": "definition_workflow_01PP77UWMZGOK7EpAqljGObzskFeYlPRah5"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01SK36PBF9P4Z3KCsK9zIdNEMLo64fxnO5O",
                "name": "Condition Branch",
                "title": "No, Threat Score and Malicious Counter are too low",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": "$activity.definition_activity_01SNJNJ2V4XPS5dAiA4YpcjUZNx53EltKYg.output.variable_workflow_01SNJIAHMHGJG5souYAjvI8XTnK9xmheUnc$",
                        "operator": "lt",
                        "right_operand": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SK37ZJTKPAS5p6H1I2q3MOpPRwrY9J1lO$"
                      },
                      "operator": "and",
                      "right_operand": {
                        "left_operand": "$activity.definition_activity_01SNJTY9NJ6153Du38Q7XYtKctqt1oK25eF.output.variable_workflow_01SNJRW778W3U660rzcZbC9I9pqAzVEL8nD$",
                        "operator": "lt",
                        "right_operand": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SNJW5SGYXCP43FuUQWwgmrkGmxObAN7H5$"
                      }
                    },
                    "operator": "and",
                    "right_operand": {
                      "left_operand": "$workflow.definition_workflow_01SDM5XW101MN0XSAaE3wZmzFjrohmKaUZh.local.variable_workflow_01SW20QH65RFL4qvyXcLHJOeevgaeisb0s6$",
                      "operator": "eq",
                      "right_operand": false
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "No, Threat Score and Malicious Counter are too low",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01SN2TEDUSY263MZsDVCII7dGoCJUI92S7N",
                    "name": "Create Approval Request",
                    "title": "Create Approval Request",
                    "type": "task.approval_request",
                    "base_type": "activity",
                    "properties": {
                      "approval_choices": [
                        "Whitelist Hash",
                        "Nothing"
                      ],
                      "assignees": [
                        "$global.variable_01SNK91FXLDQW5ycWklwZ94olaDME2Rhmug.global.variable_01SNK91FXLDQW5ycWklwZ94olaDME2Rhmug$"
                      ],
                      "continue_on_failure": false,
                      "display_name": "Create Approval Request",
                      "due_date": {
                        "is_relative_time": true,
                        "relative_time": {
                          "duration": 10,
                          "time_units": "hours"
                        },
                        "set_due_date": true
                      },
                      "expiration_date": {
                        "is_relative_time": true,
                        "relative_time": {
                          "duration": 40,
                          "time_units": "hours"
                        }
                      },
                      "expiration_status": "Expired",
                      "minimum_approvals": 1,
                      "priority": "normal",
                      "skip_execution": false,
                      "subject_line": "Possible T1091 Replication Through Removable Media",
                      "task_message": "The workflow T1091 Replication Through Removable Media identified an autorun file with unknown effects.\n\n[hash]$activity.definition_activity_01SHSH4NKY7MW3IESskeGhJ5oHEEj3A0B0C.input.source_array[@].item$[/hash]\nOriginal report: $activity.definition_activity_01SDN05H4OMWU5BlbNPCSaavgt6VMAh69xE.output.script_queries.Response$\n\nIf you wish to whitelist the hash, make sure to include a brief reasoning of the action in the text box below.\nWhat should be the action taken?",
                      "task_owner": "$global.variable_01SNK91FXLDQW5ycWklwZ94olaDME2Rhmug.global.variable_01SNK91FXLDQW5ycWklwZ94olaDME2Rhmug$",
                      "task_requestor": "$global.variable_01SNK91FXLDQW5ycWklwZ94olaDME2Rhmug.global.variable_01SNK91FXLDQW5ycWklwZ94olaDME2Rhmug$"
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
      "category_01QS01DS11DPC65yBhTpCAMYgkhp0kkxuhZ"
    ]
  },
  "categories": {
    "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m": {
      "unique_name": "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
      "name": "response",
      "title": "response",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    },
    "category_01QS01DS11DPC65yBhTpCAMYgkhp0kkxuhZ": {
      "unique_name": "category_01QS01DS11DPC65yBhTpCAMYgkhp0kkxuhZ",
      "name": "Boros Alex",
      "title": "Boros Alex",
      "type": "basic.category",
      "base_type": "category",
      "description": "Anything associated with Boros Alex's Thesis Work: Modern Automated Threat Detection and Prevention utilizing Cisco SecureX",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "targets": {
    "definition_target_01S9WJLG94O1A0HkwcNgLRoEkbShHGfAJdP": {
      "unique_name": "definition_target_01S9WJLG94O1A0HkwcNgLRoEkbShHGfAJdP",
      "name": "Boros-Thesis-AMP-API-v1",
      "title": "Boros-Thesis-AMP-API-v1",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "default_runtime_user_id": "definition_runtime_user_01S9WLCQKSIR23CZIxeJXcBxyV9TQrxMLK0",
        "description": "Target for finding computer details (Hostnames, MAC addresses, etc.) by AMP groups.",
        "disable_certificate_validation": false,
        "display_name": "Boros-Thesis-AMP-API-v1",
        "host": "api.amp.cisco.com",
        "ignore_proxy": false,
        "no_runtime_user": false,
        "path": "/v1/",
        "port": 443,
        "protocol": "https"
      }
    }
  },
  "runtime_users": {
    "definition_runtime_user_01S9WLCQKSIR23CZIxeJXcBxyV9TQrxMLK0": {
      "unique_name": "definition_runtime_user_01S9WLCQKSIR23CZIxeJXcBxyV9TQrxMLK0",
      "name": "Boros-Thesis-AMP-Basic-Auth",
      "title": "Boros-Thesis-AMP-Basic-Auth",
      "type": "runtime_user.web-service_basic_credentials",
      "base_type": "runtime_user",
      "object_type": "definition_runtime_user",
      "properties": {
        "auth_option": "*****",
        "basic_password": "*****",
        "basic_username": "*****",
        "description": "Basic authentication through HTTP for AMP.",
        "display_name": "Boros-Thesis-AMP-Basic-Auth"
      }
    }
  },
  "variables": {
    "variable_01SBMZJERN1F95k9yNMjRMOYHRRfMl0fpmd": {
      "unique_name": "variable_01SBMZJERN1F95k9yNMjRMOYHRRfMl0fpmd",
      "schema_id": "tabletype_01SBMYGBP1XID1ZmFTXxIUbLOqtUIYDBOhT",
      "properties": {
        "value": [
          {
            "column_data": {
              "description": "(black.png) A fully black 1920x1080 wallpaper.",
              "hash": "8ed817abfb94270aaf9b3f392a5927bc019277542374a9de550521e2aa34a7f6"
            }
          }
        ],
        "scope": "global",
        "name": "Boros-T1570-Lateral-Tool-Transfer-Whitelist",
        "type": "datatype.table",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_01SNK91FXLDQW5ycWklwZ94olaDME2Rhmug": {
      "unique_name": "variable_01SNK91FXLDQW5ycWklwZ94olaDME2Rhmug",
      "properties": {
        "value": "borosalex207@gmail.com",
        "scope": "global",
        "name": "Boros-Alex-Thesis-Task-Owner",
        "type": "datatype.string",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    }
  },
  "table_types": {
    "tabletype_01SBMYGBP1XID1ZmFTXxIUbLOqtUIYDBOhT": {
      "unique_name": "tabletype_01SBMYGBP1XID1ZmFTXxIUbLOqtUIYDBOhT",
      "data_type": "datatype.tabletype",
      "display_name": "Boros-T1570-Lateral-Tool-Transfer-Whitelist",
      "columns": [
        {
          "maxLength": 2048,
          "maximum": 0,
          "minimum": 0,
          "name": "description",
          "title": "Description",
          "type": "string"
        },
        {
          "is_required": true,
          "maxLength": 64,
          "maximum": 0,
          "minimum": 0,
          "name": "hash",
          "title": "Hash",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    },
    "tabletype_01SK0TY4KM6ZE46lC8puhXooy760EFgNm0Q": {
      "unique_name": "tabletype_01SK0TY4KM6ZE46lC8puhXooy760EFgNm0Q",
      "data_type": "datatype.tabletype",
      "display_name": "Boros Alex Array Table",
      "columns": [
        {
          "is_required": true,
          "maxLength": 2048,
          "maximum": 0,
          "minimum": 0,
          "name": "item",
          "title": "Item",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01PP77UWMZGOK7EpAqljGObzskFeYlPRah5",
    "definition_workflow_01SNJFC6HGYWW5JKCGBVOOUUZl4Sugo4HpA",
    "definition_workflow_01SNIPM3PE4PG6zHzzDOYlGFKOFXe6DQdIA"
  ]
}